workflow: session-insights-bootstrap-v2
description: Development workflow for session-insights CLI tool (v2 - with decomposition, KPI alignment, and circuit breakers)
agents:
- role: engineer
- role: reviewer
states:
  start:
    type: initial
    auto_transition: engineering
  engineering:
    instructions: |
      Implement the assigned task for the session-insights CLI tool.

      PHASE AWARENESS - YOU ARE IN VALIDATION MODE:
      The construction phase is complete. Measurers and pipelines exist but have
      NOT been validated against real data. Your priorities reflect this phase.

      PRIORITY ZERO - RUN MEASURERS AGAINST REAL DATA:
      Before building anything new, run ALL existing KPI measurers against real
      session data and capture actual values. If a measurer fails on real data,
      fix it. If it produces unexpected results, investigate and document why.
      You cannot improve what you haven't validated. Do not proceed to new
      feature work until measurers produce trustworthy numbers on real inputs.

      PRIORITY ONE - STRESS-TEST HIGH-RISK KPIs:
      project_notes (target 100%) and weekly_digests (target 100%) have NEVER
      been validated against real data. These aggressive targets are the highest
      risk of stalling the mission. Run them first, identify failure modes early,
      and document any gaps between actual and target values.

      PRIORITY TWO - CLOSE THE FEEDBACK LOOP:
      Exercise the full pipeline end-to-end: generate -> measure -> report.
      Integration-level validation matters more than unit tests at this stage.
      For narrative_quality (target 80%), ensure the measurer produces actionable
      feedback with explicit rubric criteria. For project_detection (target 95%),
      benchmark against a labeled test dataset of known projects.

      PRIORITY THREE - FIX BLOCKING TEST FAILURES:
      Run `uv run pytest tests/ -x -q`. If there are failing tests, fix them
      before starting new feature work. A passing test suite is the foundation.

      BACKLOG AWARENESS:
      There are carry-over tasks from the previous cycle (5 pending + 1 in-progress).
      Prioritize completing these before generating new tasks. Do not duplicate
      work that was already started.

      FAILURE RATE EXPECTATION:
      Integration and measurement tasks have a higher failure rate than construction
      tasks. If a validation task fails, investigate the root cause thoroughly
      before retrying. Do not enter a retry loop â€” if a task fails twice with the
      same error, flag it for decomposition or scope reduction.
